<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>충북 교사 전보 만기계산기 - 완전 새버전</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>충북 교사 전보 만기계산기</h1>
            <p>2025년 개정 인사관리기준 적용 - 완전히 새로운 자동 등록</p>
            <div class="regulation-badge">
                <span class="badge badge--primary">✨ 새로운 파싱 엔진</span>
                <span class="badge badge--primary">🎯 정확한 휴직 인식</span>
                <span class="badge badge--primary">⚡ 휴직복직 완전 제외</span>
            </div>
        </header>

        <main class="main-content">
            <!-- 현임교 정보 입력 -->
            <div class="calculator-section">
                <div class="card">
                    <div class="card__header">
                        <h2>🏫 현임교 정보</h2>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label for="current-region-select" class="form-label">근무 지역 *</label>
                            <select id="current-region-select" class="form-control" required>
                                <option value="">지역을 선택하세요</option>
                                <option value="chungju">충주시 (15년)</option>
                                <option value="jecheon">제천시 (15년)</option>
                                <option value="cheongju">청주시 (13년)</option>
                                <option value="other">기타지역 (8년)</option>
                            </select>
                        </div>

                        <div id="current-cheongju-sub-region" class="form-group" style="display: none;">
                            <label for="current-cheongju-type" class="form-label">청주시 세부지역</label>
                            <select id="current-cheongju-type" class="form-control">
                                <option value="dong">동지역</option>
                                <option value="eup-myeon">읍·면지역</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="current-transfer-date" class="form-label">현임교 전입일자 *</label>
                            <input type="date" id="current-transfer-date" class="form-control" required>
                        </div>

                        <div class="alert alert-info">
                            <strong>⚠️ 필수:</strong> 만기 계산을 위해 지역과 전입일자를 반드시 입력하세요.
                        </div>
                    </div>
                </div>

                <!-- 자동 등록 카드 -->
                <div class="card">
                    <div class="card__header">
                        <h2>🚀 경력 데이터 자동 등록</h2>
                        <button id="auto-parse-btn" class="btn btn--primary btn--large">📋 자동 등록 시작</button>
                    </div>
                    <div class="card__body">
                        <div class="alert alert-success">
                            <h4>✅ 새로운 파싱 엔진 특징</h4>
                            <ul>
                                <li><strong>정확한 휴직 인식:</strong> "휴직" 키워드로 정확히 분류</li>
                                <li><strong>휴직복직 제외:</strong> "휴직복직"은 자동으로 무시</li>
                                <li><strong>전보 제외:</strong> "교육청간", "교육청내" 전보 제외</li>
                                <li><strong>1년 기준 적용:</strong> 365일 이상 휴직은 학교만기 제외</li>
                            </ul>
                        </div>

                        <div class="test-data-section">
                            <h4>📋 테스트용 샘플 데이터</h4>
                            <textarea id="sample-data" readonly class="form-control" rows="6" style="font-family: monospace; font-size: 11px;">2025.03.01 ~ 2026.02.28	보직교사	부장교사(교사(중등))	충청북도교육청 충주고등학교	충주고등학교
2024.05.01 ~ 2025.02.28	담임교사	중고등학교교사(교사(중등))	충청북도교육청 충주고등학교	충주고등학교
2024.05.01 ~ 2024.05.01	휴직복직	중고등학교교사(교사(중등))	충청북도교육청 충주고등학교	교육과-5733(2024. 4. 22.)
2024.03.01 ~ 2024.04.30	7호:육아휴직(둘째)	중고등학교교사(교사(중등))	충청북도교육청 충주고등학교	충청북도충주교육지원청
2023.03.01 ~ 2024.02.29	담임교사	중고등학교교사(교사(중등))	충청북도교육청 충주여자고등학교	충주여자고등학교
2022.03.01 ~ 2022.08.21	7호:육아휴직(첫째)	중고등학교교사(교사(중등))	충청북도교육청 충주여자고등학교	충주여자고등학교
2019.02.21 ~ 2020.02.20	휴직연장	중고등학교교사(교사(중등))	충청북도교육청 충주여자고등학교	충청북도교육감</textarea>
                            <button id="copy-sample-btn" class="btn btn--outline btn--small">📋 샘플 데이터 복사</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 등록된 데이터 현황 -->
            <div class="calculator-section">
                <div class="card">
                    <div class="card__header">
                        <h2>📊 등록된 경력 데이터</h2>
                        <div class="btn-group">
                            <button id="add-school-btn" class="btn btn--secondary">+ 수동 추가</button>
                            <button id="clear-all-btn" class="btn btn--danger">🗑️ 전체 삭제</button>
                        </div>
                    </div>
                    <div class="card__body">
                        <div class="data-summary">
                            <div class="summary-item">
                                <span class="summary-label">일반 근무</span>
                                <span id="school-count" class="summary-value">0개</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">휴직</span>
                                <span id="leave-count" class="summary-value">0개</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">총 기간</span>
                                <span id="total-period" class="summary-value">0년</span>
                            </div>
                        </div>

                        <div id="registered-data-list" class="registered-data-list">
                            <p class="text-secondary">등록된 데이터가 없습니다. 자동 등록을 시작해보세요.</p>
                        </div>
                    </div>
                </div>

                <!-- 계산 결과 -->
                <div class="card">
                    <div class="card__header">
                        <h2>📈 만기 계산 결과</h2>
                        <button id="calculate-btn" class="btn btn--primary">🔄 재계산</button>
                    </div>
                    <div class="card__body">
                        <div id="calculation-status" class="alert alert-warning">
                            현임교 정보를 입력하고 경력 데이터를 등록한 후 계산됩니다.
                        </div>

                        <div id="calculation-results" class="calculation-results" style="display: none;">
                            <div class="result-grid">
                                <div class="result-card result-card--school">
                                    <div class="result-header">
                                        <h3>🏫 학교 만기</h3>
                                        <span class="result-note">현임교 5년 기준</span>
                                    </div>
                                    <div class="result-body">
                                        <div id="school-expiry-date" class="result-date">-</div>
                                        <div id="school-remaining" class="result-remaining">남은 기간: -</div>
                                        <div class="result-detail">
                                            <small>효과적 근무: <span id="school-effective-service">-</span></small>
                                        </div>
                                    </div>
                                </div>

                                <div class="result-card result-card--region">
                                    <div class="result-header">
                                        <h3>🌏 지역 만기</h3>
                                        <span class="result-note">전체 경력 기준</span>
                                    </div>
                                    <div class="result-body">
                                        <div id="regional-expiry-date" class="result-date">-</div>
                                        <div id="regional-remaining" class="result-remaining">남은 기간: -</div>
                                        <div class="result-detail">
                                            <small>지역 총 근무: <span id="regional-total-service">-</span></small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="leave-impact" class="leave-impact" style="display: none;">
                                <h4>🟠 휴직 영향 분석</h4>
                                <div id="leave-impact-content"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 자동 파싱 모달 -->
    <div id="auto-parse-modal" class="modal hidden">
        <div class="modal-content modal-content--large">
            <div class="modal-header">
                <h3>🚀 경력 데이터 자동 등록</h3>
                <button id="modal-close-btn" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="step-indicator">
                    <div class="step step--active" data-step="1">
                        <span class="step-number">1</span>
                        <span class="step-text">데이터 입력</span>
                    </div>
                    <div class="step" data-step="2">
                        <span class="step-number">2</span>
                        <span class="step-text">파싱 확인</span>
                    </div>
                    <div class="step" data-step="3">
                        <span class="step-number">3</span>
                        <span class="step-text">등록 완료</span>
                    </div>
                </div>

                <div id="step-1" class="step-content">
                    <div class="form-group">
                        <label class="form-label">
                            📋 경력 데이터 붙여넣기
                            <span class="form-help">Excel이나 한글 문서에서 복사한 표 데이터를 붙여넣으세요</span>
                        </label>
                        <textarea 
                            id="career-data-input" 
                            class="form-control form-control--large" 
                            rows="10" 
                            placeholder="여기에 경력 데이터를 붙여넣으세요...

예시 형식:
2024.03.01 ~ 2025.02.28    담임교사    중고등학교교사(교사(중등))    충청북도교육청    충주고등학교
2023.03.01 ~ 2024.02.28    7호:육아휴직(둘째)    중고등학교교사(교사(중등))    충청북도교육청    육아휴직

※ 탭으로 구분된 5개 컬럼 형식이어야 합니다"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button id="parse-data-btn" class="btn btn--primary btn--large">
                            🔍 데이터 분석하기
                        </button>
                    </div>
                </div>

                <div id="step-2" class="step-content" style="display: none;">
                    <div id="parse-results" class="parse-results">
                        <!-- 파싱 결과가 여기에 표시됩니다 -->
                    </div>
                    <div class="modal-actions">
                        <button id="back-to-input-btn" class="btn btn--secondary">← 뒤로</button>
                        <button id="confirm-parse-btn" class="btn btn--primary btn--large">
                            ✅ 이대로 등록하기
                        </button>
                    </div>
                </div>

                <div id="step-3" class="step-content" style="display: none;">
                    <div class="success-message">
                        <div class="success-icon">✅</div>
                        <h3>등록 완료!</h3>
                        <div id="registration-summary"></div>
                    </div>
                    <div class="modal-actions">
                        <button id="close-modal-btn" class="btn btn--primary btn--large">
                            완료
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 수동 추가 모달 -->
    <div id="manual-add-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>➕ 수동으로 경력 추가</h3>
                <button class="modal-close" onclick="hideManualModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">유형 선택</label>
                    <select id="manual-type" class="form-control">
                        <option value="school">일반 근무</option>
                        <option value="leave">휴직</option>
                    </select>
                </div>
                <div id="manual-form-content">
                    <!-- 동적으로 폼이 생성됩니다 -->
                </div>
                <div class="modal-actions">
                    <button onclick="hideManualModal()" class="btn btn--secondary">취소</button>
                    <button onclick="saveManualData()" class="btn btn--primary">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 표준 파일명으로 수정된 JavaScript -->
    <script src="app.js"></script>
</body>
</html>